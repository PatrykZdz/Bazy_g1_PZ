#Lab 7 #zadanie 1
#1.2
#podzapytanie lub left join
select * from kreatura k left join uczestnicy u on u.id_uczestnika=k.idKreatury
where u.id_uczestnika is null;

#1.3
select w.nazwa, sum(e.ilosc) from wyprawa w inner join uczestnicy u on 
w.id_wyprawy=u.id_wyprawy inner join ekwipunek e 
on u.id_uczestnika=e.idKreatury group by w.id_wyprawy;

# Zadanie 2 
# 2.1 
select w.nazwa, count(u.id_uczestnika), group_concat(k.nazwa separator ' | ') from wyprawa w 
join uczestnicy u on u.id_wyprawy=w.id_wyprawy join kreatura k
on k.idKreatury = u.id_uczestnika group by w.id_wyprawy;

# 2.2 
select w.nazwa, w.data_rozpoczecia, k.nazwa as kierownik, ew.kolejnosc, s.nazwa from etapy_wyprawy ew 
join sektor s on ew.sektor=s.id_sektora
join wyprawa w on w.id_wyprawy = ew.idWyprawy 
join kreatura k on k.idKreatury=w.kierownik
order by w.data_rozpoczecia desc, ew.kolejnosc asc;

# zadanie 3 dokonczyc 
# 3.1
Select count(id_sektora) from sektor;
select count(distinct sektor) from etapy_wyprawy;

Select nazwa,ifnull(waga, 'bez wagi') as waga from kreatura;
Select nazwa,if(waga is null, 'bez wagi', waga) as waga from kreatura;

#Dobrze
select s.nazwa, count(ew.sektor) as ile_odwidzin from sektor s left join 
etapy_wyprawy ew on s.id_sektora=ew.sektor group by s.id_sektora;

# 3.2

Select k.nazwa, if(count(u.id_uczestnika)>0,'bral udział w wyprawie',
'nie brał udziału w wyprawie') bral_czy_nie
from kreatura k 
left join uczestnicy u on k.idKreatury=u.id_uczestnika
group by k.idKreatury;

#wejsciowka moja
#1. 
select s.imie, s.nazwisko, sum(w.iloscPunktow) from student s inner
join wyniki w on s.idStudenta= w.idStudenta
group by s.idStudenta;
#2.
Select dyscyplina, avg(iloscPunktow)
from wyniki group by dyscyplina;
#3. 
Select imie, nazwisko from student s left join wyniki w on s.idStudenta=w.idStudenta
where dyscyplina/w.idStudenta is Null;

#wejsciowka 2
select s.imie, s.nazwisko, sum(w.iloscPunktow) from studend s 
inner join wyniki w on s.idStudenta=w.idStudenta where 
2022-year(student.dataUrodzenia) between 20 and 29
group by s.idStudenta;
#zad2
select count(distinct dyscyplina) from wyniki;
