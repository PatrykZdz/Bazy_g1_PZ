#lab 5 zad 3.1 - OK 
SELECT dataPozyskania 
,year (dataPozyskania)
,month (dataPozyskania)
,day(dataPozyskania)
from zasob;

select * from zasob where month (dataPozyskania) in (7,8);
#zadanie 3.2 - OK 

select * from zasob where rodzaj is not null order by waga ASC;

#order by wiek ASC, rodzaj DESC;
#order by 1 ASC , 2 DESC:

#zadanie 3.3 - OK
SELECT * from kreatura order by dataUr ASC limit 5;

SELECT * from kreatura order by dataUr limit 5,5;

#zadanie 4.1 
select distinct rodzaj from zasob;

select distinct nazwa,dataPozyskania from zasob;

#zadanie 4.2 - do konczyć
#funkcja concat()
select concat(nazwa,rodzaj) from kreatura;
select concat("Nazywam się ",nazwa) from kreatura;

#zadanie 4.3 
select nazwa,ilosc * waga from zasob
where year (dataPozyskania) between 2000 and 2007;

#zadanie 5.1 
Select nazwa ,(ilosc*waga)*0.7 as waga_netto,
(ilosc*waga) *0.3 as odpadki from zasob
where rodzaj = 'jedzenie';

#zadanie 5.2 
select * from zasob where rodzaj is null;

#zadanie 5.3 
# nazwa , zasob ,rodzaj # 4 wartosci; dokoncz;

select distinct rodzaj,nazwa from zasob where nazwa = 'Ba%' and '%os' ;

#lab 6 zadanie 1.1
select sum(udzwig) from kreatura;

select avg(waga) from kreatura where rodzaj = 'wiking'; # dobrze;

#zadanie 1.2
select nazwa,rodzaj, avg(waga), count(*) from kreatura group by rodzaj;
#zadanie 1.3
select * from kreatura;

select rodzaj, avg(year(dataUr)) from kreatura group by rodzaj; # zle

select rodzaj, avg(2022-year(dataUr)) as sredni_wiek
from kreatura group by rodzaj;

#zadanie 2.1
select nazwa,rodzaj, sum(waga*ilosc) from zasob group by nazwa, rodzaj with rollup order by rodzaj;

select year (dataPozyskania) as rok , 
month (dataPozyskania) as miesiac,
count(*)
from zasob group by rok, miesciac;

#zadanie 2.2
# ta suma = srednia
# having filtr dla kolumn agregowanych, po agregacji.
select rodzaj, count(nazwa) from kreatura group by rodzaj
having count(nazwa) > 1;
#zadanie 2.2 dobrze

select nazwa, avg(waga) from zasob
where ilosc >=4
group by nazwa having avg(waga) > 10 and sum(ilosc) >= 4;

#zadanie 2.3

select rodzaj,nazwa, count(nazwa) from zasob group by rodzaj
having sum(ilosc) > 1;

#zadanie 3.1 - zlączenie tabel
select * from kreatura, ekwipunek
where kreatura.idKreatury=ekwipunek.idKreatury;

select k.nazwa, e.ilosc, e.idZasobu from kreatura k inner join ekwipunek e
inner join zasob z on z.idZasobu=e.idZasobu on k.idKreatury=e.idKreatury;


select * from kreatura k left join ekwipunek e on k.idKreatury=e.idKreatury
where e.idEkwipunku is not null; #inner join bez null left join.

#zadanie 3.3 - ok /left join
select * from kreatura k left join ekwipunek e on k.idKreatury=e.idKreatury
where e.idEkwipunku is null;
#pod zapytanie
select idKreatury from kreatura where idKreatury not in (
select distinct idKreatury from ekwipunek
where idKreatury is not null);
#zadanie 4 pkt 1,2 i to wszytko czego nie dokoczył

SELECT *  FROM kreatura k JOIN ekwipunek e 
ON k.idKreatury=e.idKreatury
join zasob z ON e.idZasobu=z.idZasobu;

#Zadanie 4 
#4.1
SELECT k.nazwa, z.nazwa, dataUr FROM wikingowie.zasob z INNER JOIN wikingowie.kreatura k 
INNER JOIN wikingowie.ekwipunek ON wikingowie.ekwipunek.idKreatury=k.idKreatury 
ON wikingowie.ekwipunek.idZasobu=z.idZasobu WHERE dataUr LIKE '167%';

#4.2



#4.3
select concat(k1.nazwa,' - ',k2.nazwa) from kreatura k1
join kreatura k2 on k1.idKreatury=k2.idKreatury-5;

#wersja 0.3
#1. SELECT * FROM student WHERE idStudenta IN(5,10,15) ORDER BY iloscPunktow DESC;
#2. SELECT * FROM student WHERE month(dataUrodzenia) in (5,9,11);
#3. (dobrze) SELECT * FROM (SELECT * FROM student ORDER BY iloscPunktow DESC LIMIT 3) AS pod ORDER BY pod.iloscPunktow ASC;
#3. SELECT * FROM student ORDER BY iloscPunktow ASC LIMIT 3;


#Zadanie 5 
#5.1
select k.rodzaj, sum(e.ilosc*z.waga)/count(distinct(k.nazwa)) as srednia_waga
from kreatura k join ekwipunek e on k.idKreatury=e.idKreatury
join zasob z on e.idZasobu=z.idZasobu where k.rodzaj not in ('malpa','waz')
group by k.rodzaj;

#5.2
SELECT k.rodzaj, max(k.dataUr), min(k.dataUr) from kreatura k
group by k.rodzaj;
 
# lub użycie UNION 

select k.nazwa from kreatura k where k.rodzaj = 'wiking' 
union
select k.nazwa from kreatura k where k.rodzaj = 'ryba';


#Lab 7

show create table uczestnicy;
#zadanie 1
#1.2
#podzapytanie lub left join
Select idKreatury from kreatura k join 
select id_uczestnika from uczestnicy;

select * from uczestnicy u 
left join kreatura k  on u.id_uczestnika=k.idKreatury;
#Dobrze zadanie
select * from kreatura k left join uczestnicy u on u.id_uczestnika=k.idKreatury
where u.id_uczestnika is null;
#1.3
#zlaczyc kreatury, ekwipunek i wyprawe
select * from wyprawa w inner join uczestnicy u on 
w.id_wyprawy=u.id_wyprawy inner join ekwipunek e 
on u.id_uczestnika=e.idKreatury;

#dobrze 1.3
select w.nazwa, sum(e.ilosc) from wyprawa w inner join uczestnicy u on 
w.id_wyprawy=u.id_wyprawy inner join ekwipunek e 
on u.id_uczestnika=e.idKreatury group by w.id_wyprawy;
